(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/study/queryGrades/queryGrades"],{202:function(e,n,t){"use strict";(function(e,n){var r=t(4);t(26);r(t(25));var o=r(t(203));e.__webpack_require_UNI_MP_PLUGIN__=t,n(o.default)}).call(this,t(1)["default"],t(2)["createPage"])},203:function(e,n,t){"use strict";t.r(n);var r=t(204),o=t(206);for(var u in o)["default"].indexOf(u)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(u);t(208);var c,a=t(34),s=Object(a["default"])(o["default"],r["render"],r["staticRenderFns"],!1,null,null,null,!1,r["components"],c);s.options.__file="pages/study/queryGrades/queryGrades.vue",n["default"]=s.exports},204:function(e,n,t){"use strict";t.r(n);var r=t(205);t.d(n,"render",(function(){return r["render"]})),t.d(n,"staticRenderFns",(function(){return r["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return r["recyclableRender"]})),t.d(n,"components",(function(){return r["components"]}))},205:function(e,n,t){"use strict";var r;t.r(n),t.d(n,"render",(function(){return o})),t.d(n,"staticRenderFns",(function(){return c})),t.d(n,"recyclableRender",(function(){return u})),t.d(n,"components",(function(){return r}));try{r={uniSection:function(){return t.e("uni_modules/uni-section/components/uni-section/uni-section").then(t.bind(null,256))},hpyFormSelect:function(){return t.e("uni_modules/hpy-form-select/components/hpy-form-select/hpy-form-select").then(t.bind(null,341))},uniCard:function(){return t.e("uni_modules/uni-card/components/uni-card/uni-card").then(t.bind(null,242))},uCountTo:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-count-to/u-count-to")]).then(t.bind(null,348))},gradeCard:function(){return t.e("components/gradeCard/gradeCard").then(t.bind(null,320))}}}catch(a){if(-1===a.message.indexOf("Cannot find module")||-1===a.message.indexOf(".vue"))throw a;console.error(a.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var o=function(){var e=this,n=e.$createElement,t=(e._self._c,e.grades.length),r=e.getGenaralGPA();e.$mp.data=Object.assign({},{$root:{g0:t,m0:r}})},u=!1,c=[];o._withStripped=!0},206:function(e,n,t){"use strict";t.r(n);var r=t(207),o=t.n(r);for(var u in r)["default"].indexOf(u)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(u);n["default"]=o.a},207:function(e,n,t){"use strict";(function(e){function r(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=o(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,u=function(){};return{s:u,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){s=!0,c=e},f:function(){try{a||null==t.return||t.return()}finally{if(s)throw c}}}}function o(e,n){if(e){if("string"===typeof e)return u(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?u(e,n):void 0}}function u(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c=function(){t.e("components/gradeCard/gradeCard").then(function(){return resolve(t(320))}.bind(null,t)).catch(t.oe)},a={data:function(){return{year:[],grades:[],semester:"2022-2023-1"}},onLoad:function(){var n=this,t=e.getStorageSync("token"),o=e.getStorageSync("username"),u=this.semester;console.log(u),console.log(t),console.log("获取token成功");var c=this;try{new Promise((function(u,a){e.request({url:"http://jwxt.qlu.edu.cn/app.do",method:"GET",data:{method:"getCjcx",xh:o},header:{token:t},success:function(e){if(JSON.stringify(e).includes("token"))console.log("token过期"),n.$_tokens.mytoken.refreshToken();else{var t,o=new Set,a=r(e.data);try{for(a.s();!(t=a.n()).done;){var s=t.value;o.add(s["xqmc"])}}catch(h){a.e(h)}finally{a.f()}for(var i=Array.from(o),l=0,d=i;l<d.length;l++){var f=d[l];n.year.push(f)}console.log(c.year),u()}},fail:function(){console.log("获取失败"),a()}})})),new Promise((function(u,a){e.request({url:"http://jwxt.qlu.edu.cn/app.do",method:"GET",data:{method:"getCjcx",xh:o,xnxqid:c.semester},header:{token:t},success:function(e){if(JSON.stringify(e).includes("token"))console.log("token过期"),n.$_tokens.mytoken.refreshToken();else{var t,o=r(e.data);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=[];s.push(a["kcmc"]),s.push(a["kclbmc"]),s.push(a["zcj"]),s.push(a["xf"]),c.grades.push(s)}}catch(i){o.e(i)}finally{o.f()}console.log(c.grades),u()}},fail:function(){console.log("获取失败"),a()}})}))}catch(a){console.log("token过期")}},computed:{all_grades:function(){return this.grades.length}},methods:{change:function(e){this.semester=e.value,this.getGrades(e.value),console.log(this.semester)},getGPA:function(e){return e>95?5:e>=60?e/10-4.5:0},getGenaralGPA:function(){var e=0,n=0;if(0==this.grades.length)return 0;var t,o=r(this.grades);try{for(o.s();!(t=o.n()).done;){var u=t.value;if("公选"!==u[1]){e+=u[3];var c=this.getGPA(Number(u[2]));n+=c*u[3]}}}catch(a){o.e(a)}finally{o.f()}return console.log("学分总和为 "+e),(n/e).toFixed(1)},getGrades:function(n){var t=this,o=e.getStorageSync("token"),u=e.getStorageSync("username"),c=this.semester;this.grades=[],console.log(c),console.log(o),console.log("获取token成功");var a=this;try{new Promise((function(c,s){e.request({url:"http://jwxt.qlu.edu.cn/app.do",method:"GET",data:{method:"getCjcx",xh:u,xnxqid:n},header:{token:o},success:function(e){if(JSON.stringify(e).includes("token"))console.log("token过期"),t.$_tokens.mytoken.refreshToken();else{var n,o=r(e.data);try{for(o.s();!(n=o.n()).done;){var u=n.value,s=[];s.push(u["kcmc"]),s.push(u["kclbmc"]),s.push(u["zcj"]),s.push(u["xf"]),a.grades.push(s)}}catch(i){o.e(i)}finally{o.f()}console.log(a.grades),c()}},fail:function(){console.log("获取失败"),s()}})}))}catch(s){console.log("token过期")}}},components:{gradeCard:c}};n.default=a}).call(this,t(2)["default"])},208:function(e,n,t){"use strict";t.r(n);var r=t(209),o=t.n(r);for(var u in r)["default"].indexOf(u)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(u);n["default"]=o.a},209:function(e,n,t){}},[[202,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/study/queryGrades/queryGrades.js.map